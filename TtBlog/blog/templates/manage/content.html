{% extends "manage/base.html" %}

{% block content %}

<div ms-controller="post">
    <div class="row">
        <div class="col-md-12">
            <h3 class="page-header">文章管理</h3>
        </div>
        <!-- /.col-lg-12 -->
    </div>

    <div class="row">
        <div class="col-md-12" >
            <a class="btn btn-success" ms-click="query(1)" style="margin-right: 10px;">刷新列表</a>
            <a class="btn btn-primary" href="/manage/addpost">添加文章</a>
        </div>
    </div>
    <div class="row" style="margin-top:15px;">
        <div class="col-md-12">
            <table class="table table-striped table-bordered table-hover">
                <thead>
                <tr>
                    <th style="width:50px;">#</th>
                    <th>标题</th>
                    <th style="width:80px;">主图</th>
                    <th style="width:150px;">创建时间</th>
                    <th style="width:120px;">创建人</th>
                    <th style="width:130px;">操作</th>
                </tr>
                </thead>
                <tbody>

                <tr ms-for="($index, el) in @posts">
                    <td>{? $index + 1 ?}</td>
                    <td><a ms-attr="{href: '/post/' + el.Id}" target="_blank">{? el.Title ?}</a> </td>

                    <td ms-if="el.Banner"><a ms-attr='{ href: el.Banner }' target="_blank"><i class="fa fa-image"></i></a></td>
                    <td ms-if="!el.Banner"><i class="fa fa-image"></i></td>

                    <td>{? el.CreateTime ?}</td>
                    <td>{? el.first_name ?} {? el.last_name ?}</td>
                    <td>
                        <a class="btn btn-success btn-sm" ms-attr="{ href: '/manage/editpost/' + el.Id }" style="margin-right: 5px;">编辑</a>&nbsp;
                        <a class="btn btn-danger btn-sm" ms-click="remove(el.Id)">删除</a>
                    </td>
                </tr>

                </tbody>
            </table>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12" style="text-align:center;">
            <nav aria-label="Page navigation">
                <ul class="pagination">
                    <li>
                        <a aria-label="Previous" ms-click="query(1)">
                            <span aria-hidden="true">&laquo;</span>
                        </a>
                    </li>
                    <li>
                        <a ms-click="prev">上一页</a>
                    </li>
                    <li>
                        <a ms-click="next">下一页</a>
                    </li>
                    <li>
                        <a aria-label="Next" ms-click="query(@totalPage)">
                            <span aria-hidden="true">&raquo;</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>
</div>

{% endblock %}

{% block script %}

<script src="/static/manage/js/biz/post.js"></script>

<script type="text/javascript">

    $(function () {
        vm.query(1);
    })

</script>

{% endblock %}